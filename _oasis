# -*- conf -*-
OASISFormat:  0.4
OCamlVersion: >= 4.03.0
Name:         brotli
Version:      1.2.0
Maintainers:  Edgar Aroutiounian
Homepage:     http://hyegar.com
Synopsis:     Bindings to Google's Brotli compresion algorithm
Authors:      Edgar Aroutiounian <edgar.factorial@gmail.com>
License:      BSD-3-clause
Plugins:      META (0.4), DevFiles (0.4)
AlphaFeatures: ocamlbuild_more_args
BuildTools: ocamlbuild, ocamldoc

Description:
  OCaml Bindings to brotli, Google's compression algorithm for the web

  Source: https://github.com/google/brotli/
  RFC: http://www.ietf.org/id/draft-alakuijala-brotli

Library brotli
  Path: src
  install: true
  CClib:
    -L/usr/local/lib -lbrotlidec -lbrotlienc -lc++
  # Note how only the native compiler gets -fsanitize=address
  # So that the byte code works without having to have
  # the sanitize library
  CCOpt:
    -Wextra -fno-omit-frame-pointer
    -fsanitize=undefined-trap -fsanitize-undefined-trap-on-error
    -O2 -fno-optimize-sibling-calls
    -std=c++14 -x c++ -I/usr/local/include 
  NativeOpt:
    -cc clang++ -w +a-4-40..42-44-45-48 -O2
    -cclib -fsanitize=address -ccopt -fsanitize=address
  ByteOpt:
    -cc clang++ -w +a-4-40..42-44-45-48
  Modules: Brotli
  CSources: brotli_stubs.c

Executable stress_test
  Path: example
  install: false
  MainIs: e.ml
  CompiledObject: native
  NativeOpt: -g -w +a-4-40..42-44-45-48
  ByteOpt: -g -w +a-4-40..42-44-45-48
  BuildDepends: brotli

SourceRepository master
  Type:     git
  Location: https://github.com/fxfactorial/ocaml-brotli.git
  Browser:  https://github.com/fxfactorial/ocaml-brotli

Document api
  Title:              Documentation and API reference for Brotli
  Type:               ocamlbuild (0.4)
  InstallDir:         $htmldir/brotli
  PostCommand:        cp doc/style.css api.docdir && cp api.docdir/* doc
  XOCamlbuildPath:    doc
  XOCamlbuildModules: src/Brotli
  Install:            true
  XOCamlbuildExtraArgs:
    "-docflags '-colorize-code -charset utf-8 -hide Brotli -hide Pervasives'"